<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Pythonå®ç°æ–‡æœ¬è§£æå™¨</title>
      <link href="2021/06/17/Python%E5%AE%9E%E7%8E%B0%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90%E5%99%A8/"/>
      <url>2021/06/17/Python%E5%AE%9E%E7%8E%B0%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Python-å®ç°æ–‡æœ¬è§£æå™¨"><a href="#Python-å®ç°æ–‡æœ¬è§£æå™¨" class="headerlink" title="Python å®ç°æ–‡æœ¬è§£æå™¨ "></a><a href="https://www.lanqiao.cn/courses/70/">Python å®ç°æ–‡æœ¬è§£æå™¨ </a></h1><span id="more"></span><h2 id="ä¸€ã€-å†…å®¹ä»‹ç»"><a href="#ä¸€ã€-å†…å®¹ä»‹ç»" class="headerlink" title="ä¸€ã€ å†…å®¹ä»‹ç»"></a>ä¸€ã€ å†…å®¹ä»‹ç»</h2><p>æœ¬èŠ‚å®éªŒæˆ‘ä»¬å­¦ä¹ ä½¿ç”¨ Python æ¥è§£æçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆ HTML é¡µé¢ã€‚æœ¬èŠ‚å®éªŒåªæ˜¯ä¸€ä¸ªç®€å•å®ç°ï¼Œæ”¯æŒäº†è¾ƒå°‘éƒ¨åˆ†çš„ Markdown è¯­æ³•ï¼Œä½†é€šè¿‡å®éªŒä¸­çš„è§£æå®ç°æ€è·¯ï¼ŒåŒå­¦ä»¬å¯ä»¥å®Œæˆæ›´å¤šæ›´å¤æ‚çš„è¯­æ³•è§£æå®ç°ã€‚</p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>-Python åŸºæœ¬è¯­æ³•</p><p>-Python é¢å‘å¯¹è±¡ç¼–ç¨‹</p><p>-yield å…³é”®å­—</p><p>-æ­£åˆ™è¡¨è¾¾å¼</p><p>-HTML æ ‡è®°è¯­è¨€</p><h2 id="äºŒã€å®ç°åŸç†åŠæ­¥éª¤"><a href="#äºŒã€å®ç°åŸç†åŠæ­¥éª¤" class="headerlink" title="äºŒã€å®ç°åŸç†åŠæ­¥éª¤"></a>äºŒã€å®ç°åŸç†åŠæ­¥éª¤</h2><p>ä¸€å…±æœ‰æ–‡æœ¬å—ç”Ÿæˆå™¨ã€å¤„ç†ç¨‹åºã€è§„åˆ™ã€è§£æå’Œè¿è¡Œä¸æµ‹è¯•äº”ä¸ªæ­¥éª¤ï¼Œæœ¬è¯¾ç¨‹ä¸­å°†åˆ›å»ºä»¥ä¸‹çš„ä»£ç æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨ç®€ä»‹å¦‚ä¸‹ï¼š</p><p><strong>â€¢util.py</strong>ï¼šå®ç°æ–‡æœ¬å—ç”Ÿæˆå™¨æŠŠçº¯æ–‡æœ¬åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„æ–‡æœ¬å—ï¼Œä»¥ä¾¿æ¥ä¸‹æ¥å¯¹æ¯ä¸€ä¸ªæ–‡æœ¬å—è¿›è¡Œè§£æ</p><p><strong>â€¢handlers.py</strong>ï¼šä¸ºæ–‡æœ¬å—æ‰“ä¸Šåˆé€‚çš„ HTML æ ‡è®°</p><p><strong>â€¢rules.py</strong>ï¼šè®¾è®¡ä¸€å®šçš„è§„åˆ™æ¥åˆ¤æ–­æ¯ä¸ªæ–‡æœ¬å—äº¤ç»™å¤„ç†ç¨‹åºå°†è¦åŠ ä»€ä¹ˆæ ‡è®°</p><p><strong>â€¢markup.py</strong>ï¼šå¯¹æ•´ä¸ªæ–‡æœ¬è¿›è¡Œè§£æçš„ç¨‹åº</p><h2 id="ä¸‰ã€-æºä»£ç "><a href="#ä¸‰ã€-æºä»£ç " class="headerlink" title="ä¸‰ã€ æºä»£ç "></a>ä¸‰ã€ æºä»£ç </h2><h3 id="1-util-py"><a href="#1-util-py" class="headerlink" title="1.util.py"></a>1.util.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;å¤„ç† TXT æ–‡æœ¬ï¼Œåˆ›å»ºè¿”å›æ–‡æœ¬å—çš„ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå™¨å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨ä¸ºç”Ÿæˆå™¨</span></span><br><span class="line"><span class="comment"># è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œfile å‚æ•°ä¸€å®šæ˜¯ IOWrapper å¯¹è±¡ï¼ŒIOWrapper å¯¹è±¡æ˜¯è¿­ä»£å™¨å¯¹è±¡</span></span><br><span class="line"><span class="comment"># è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯ç»™æ–‡æœ¬æ–‡ä»¶çš„ IOWrapper è¿­ä»£å™¨çš„æœ«å°¾å¢åŠ ä¸€ä¸ªæ¢è¡Œç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lines</span>(<span class="params">file</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆå™¨ï¼Œåœ¨æ–‡æœ¬æœ€ååŠ ä¸€ç©ºè¡Œ</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        <span class="keyword">yield</span> line</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒä¸Šä¸€ä¸ªå‡½æ•° lines ï¼Œå®ƒä¹Ÿæ˜¯ä¸ªç”Ÿæˆå™¨å‡½æ•°</span></span><br><span class="line"><span class="comment"># è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œfile å‚æ•°ä¸€å®šæ˜¯ IOWrapper å¯¹è±¡ï¼ŒIOWrapper å¯¹è±¡æ˜¯è¿­ä»£å™¨å¯¹è±¡</span></span><br><span class="line"><span class="comment"># å‡½æ•°çš„è¿”å›å€¼æ˜¯ç”Ÿæˆå™¨ï¼Œç”Ÿæˆå™¨çš„æ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–‡æœ¬å—</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">blocks</span>(<span class="params">file</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆå™¨ï¼Œå°† TXT æ–‡ä»¶å†…å®¹ç”Ÿæˆä¸€ä¸ªä¸ªå•ç‹¬çš„æ–‡æœ¬å—ï¼ŒæŒ‰ç©ºè¡Œåˆ†</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    block = []</span><br><span class="line">    <span class="comment"># ä½¿ç”¨ for å¾ªç¯è°ƒç”¨ç”Ÿæˆå™¨</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines(file):</span><br><span class="line">        <span class="comment"># å¦‚æœä¸æ˜¯ç©ºè¡Œ</span></span><br><span class="line">        <span class="keyword">if</span> line.strip():</span><br><span class="line">            <span class="comment"># å°†è¯¥è¡Œæ•°æ®æ·»åŠ åˆ° block åˆ—è¡¨é‡Œ</span></span><br><span class="line">            block.append(line)</span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯ç©ºè¡Œï¼Œä¸” block åˆ—è¡¨é‡Œæœ‰å†…å®¹</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œå¯ä»¥çœ‹å‡º lines ç”Ÿæˆå™¨å‡½æ•°çš„ä½œç”¨äº†ï¼Œå¦‚æœæœ€åä¸€è¡Œä¸æ˜¯ç©ºè¡Œ</span></span><br><span class="line">        <span class="comment"># é‚£ä¹ˆæœ€åä¸€ä¸ªæ–‡æœ¬å—å°±ä¸ä¼šä½œä¸º yield çš„å‚æ•°è¢«ç”Ÿæˆå™¨è¿”å›</span></span><br><span class="line">        <span class="keyword">elif</span> block:</span><br><span class="line">            <span class="keyword">yield</span> <span class="string">&#x27;&#x27;</span>.join(block).strip()</span><br><span class="line">            <span class="comment"># æ¯æ¬¡ç”Ÿæˆæ–‡æœ¬å—åï¼Œè¦æ¸…ç©º block åˆ—è¡¨</span></span><br><span class="line">            block = []</span><br></pre></td></tr></table></figure><h3 id="2-handlers-py"><a href="#2-handlers-py" class="headerlink" title="2.handlers.py"></a>2.handlers.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">HTML æ–‡æœ¬å¤„ç†ç±»ï¼Œç”¨äºæ‰“å°å„ç§ HTML æ ‡ç­¾</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¤„ç†ç¨‹åºçˆ¶ç±»</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">self, prefix, name, *args</span>):</span></span><br><span class="line">        <span class="comment"># è·å–å¤„ç†æ–¹æ³•ï¼Œgetattr æ¥æ”¶ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="comment"># 1ã€Python å¯¹è±¡</span></span><br><span class="line">        <span class="comment"># 2ã€å±æ€§å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="comment"># 3ã€ç¼ºçœå€¼</span></span><br><span class="line">        <span class="comment"># è¿”å›å€¼ä¸º Python å¯¹è±¡çš„å±æ€§å€¼ï¼Œå¦‚æœæ²¡æœ‰æ­¤å±æ€§å€¼ï¼Œè¿”å›ç¬¬ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">        method = <span class="built_in">getattr</span>(self, prefix + name, <span class="literal">None</span>)</span><br><span class="line">        <span class="comment"># è°ƒç”¨å¤„ç†æ–¹æ³•ï¼Œå°†å…¶è¿”å›å€¼ä½œä¸ºå½“å‰å‡½æ•°çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">callable</span>(method): <span class="keyword">return</span> method(*args)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.callback(<span class="string">&#x27;start_&#x27;</span>, name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.callback(<span class="string">&#x27;end_&#x27;</span>, name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‚æ•° name çš„å€¼ä¸ºè¿‡æ»¤å™¨åå­—ï¼Œæ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sub</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">substitution</span>(<span class="params">match</span>):</span></span><br><span class="line">            result = self.callback(<span class="string">&#x27;sub_&#x27;</span>, name, match)</span><br><span class="line">            <span class="keyword">if</span> result <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                result = match.group(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">return</span> substitution</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTMLRenderer</span>(<span class="params">Handler</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    HTML å¤„ç†ç¨‹åºï¼Œç»™æ–‡æœ¬å—åŠ ç›¸åº”çš„ HTML æ ‡è®°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä»¥ä¸‹å„ä¸ªæ–¹æ³•åˆ†åˆ«åœ¨ç¬¦åˆæ¡ä»¶æ—¶è¢«è°ƒç”¨ï¼Œæ‰“å°æ ‡ç­¾æˆ–æ ‡ç­¾çš„ text å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_document</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;html&gt;&lt;head&gt;&lt;title&gt;ShiYanLou&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_document</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/body&gt;&lt;/html&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_paragraph</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;p style=&quot;color: #444;&quot;&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_paragraph</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/p&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_heading</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;h2 style=&quot;color: #68BE5D;&quot;&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_heading</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/h2&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_list</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;ul style=&quot;color: #363736;&quot;&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_list</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/ul&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_listitem</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;li&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_listitem</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/li&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_title</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;h1 style=&quot;color: #1ABC9C;&quot;&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_title</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&lt;/h1&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sub_emphasis</span>(<span class="params">self, match</span>):</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="string">&#x27;&lt;em&gt;%s&lt;/em&gt;&#x27;</span> % match.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sub_url</span>(<span class="params">self, match</span>):</span></span><br><span class="line">        s = (<span class="string">&#x27;&lt;a target=&quot;_blank&quot; style=&quot;text-decoration: none;&#x27;</span></span><br><span class="line">                <span class="string">&#x27;color: #BC1A4B;&quot; href=&quot;&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">format</span>(match.group(<span class="number">1</span>), match.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sub_mail</span>(<span class="params">self, match</span>):</span></span><br><span class="line">        s = (<span class="string">&#x27;&lt;a style=&quot;text-decoration: none;color: #BC1A4B;&quot; &#x27;</span></span><br><span class="line">                <span class="string">&#x27;href=&quot;mailto:&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">format</span>(match.group(<span class="number">1</span>), match.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">feed</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><h3 id="3-rules-py"><a href="#3-rules-py" class="headerlink" title="3.rules.py"></a>3.rules.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;å¤„ç†æ–‡æœ¬å—çš„è§„åˆ™ç±»ï¼Œæ‰€æœ‰ç±»å‡ä¸ºå•ä¾‹æ¨¡å¼ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶é™¤äº† Rule æ¯ä¸ªç±»ä»…åˆ›å»ºä¸€ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rule</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰€æœ‰è§„åˆ™ç±»çš„çˆ¶ç±»</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">self, block, handler</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åŠ æ ‡è®°ï¼Œä»¥ä¸‹ä¸‰è¡Œæ‰§è¡Œæ‰“å° HTML æ ‡ç­¾çš„åŠŸèƒ½</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        handler.start(self.<span class="built_in">type</span>)    <span class="comment"># æ‰“å°æ ‡ç­¾å¤´</span></span><br><span class="line">        handler.feed(block)         <span class="comment"># æ‰“å°æ ‡ç­¾ text éƒ¨åˆ†</span></span><br><span class="line">        handler.end(self.<span class="built_in">type</span>)      <span class="comment"># æ‰“å°æ ‡ç­¾å°¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>                 <span class="comment"># æ‰“å°å®Œæˆï¼Œè¿”å› True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeadingRule</span>(<span class="params">Rule</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä¸€å·æ ‡é¢˜è§„åˆ™ï¼ŒHTML æ–‡ä»¶çš„ä¸€çº§æ ‡é¢˜è§„åˆ™ï¼ˆæœ€å¤§å­—å·ï¼‰&lt;h1&gt; æ ‡ç­¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">type</span> = <span class="string">&#x27;heading&#x27;</span>    <span class="comment"># æ–‡æœ¬å—ç±»å‹</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">condition</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆ¤æ–­æ–‡æœ¬å—æ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œè¿”å›å€¼ä¸ºå¸ƒå°”å€¼ True æˆ– False</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> <span class="string">&#x27;\n&#x27;</span> <span class="keyword">in</span> block <span class="keyword">and</span> <span class="built_in">len</span>(block) &lt;= <span class="number">70</span> <span class="keyword">and</span> <span class="keyword">not</span> block[-<span class="number">1</span>] == <span class="string">&#x27;:&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TitleRule</span>(<span class="params">HeadingRule</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    äºŒå·æ ‡é¢˜è§„åˆ™ï¼Œæ¬¡çº§æ ‡é¢˜è§„åˆ™ï¼Œç»§æ‰¿ä¸€å·æ ‡é¢˜è§„åˆ™ç±» &lt;h2&gt; æ ‡ç­¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">type</span> = <span class="string">&#x27;title&#x27;</span>  <span class="comment"># æ–‡æœ¬å—ç±»å‹</span></span><br><span class="line">    first = <span class="literal">True</span>    <span class="comment"># è¿™æ˜¯ä¸€ä¸ªæµ®åŠ¨å€¼</span></span><br><span class="line">                    <span class="comment"># é¦–æ¬¡è°ƒç”¨è¯¥ç±»çš„å®ä¾‹ï¼Œè¯¥å€¼ä¸º True</span></span><br><span class="line">                    <span class="comment"># ä¹‹åè°ƒç”¨è¯¥ç±»çš„å®ä¾‹ï¼Œè¯¥å€¼ä¸º False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">condition</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        <span class="comment"># ä»¥ä¸‹ä¸‰è¡Œä»£ç ä¿è¯åœ¨é¦–æ¬¡è°ƒç”¨è¯¥ç±»å®ä¾‹å’Œåç»­è°ƒç”¨æ—¶ first çš„å€¼ä¸åŒ</span></span><br><span class="line">        <span class="comment"># ç¬¦åˆä¸€å·æ ‡é¢˜è§„åˆ™çš„æ–‡æœ¬å—ä¸€å®šç¬¦åˆäºŒå·æ ‡é¢˜è§„åˆ™ï¼Œå®ƒä»¬åªæœ‰å…ˆåæ¬¡åºè¿™ä¸€ä¸ªåŒºåˆ«</span></span><br><span class="line">        <span class="comment"># é¦–æ¬¡è°ƒç”¨æ—¶è¿”å› False ï¼Œå³ä»£ç å—ä¸ç¬¦åˆäºŒå·æ ‡é¢˜è§„åˆ™</span></span><br><span class="line">        <span class="comment"># ä¹‹åè°ƒç”¨è¿”å› True ï¼Œå³ä½¿ç”¨è¯¥ç±»çš„ action æ–¹æ³•è¿›è¡Œå¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.first:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        self.first = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().condition(block)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListItemRule</span>(<span class="params">Rule</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ—è¡¨é¡¹è§„åˆ™ï¼Œ&lt;li&gt; æ ‡ç­¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">type</span> = <span class="string">&#x27;listitem&#x27;</span>   <span class="comment"># æ–‡æœ¬å—ç±»å‹</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">condition</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        <span class="comment"># è¡Œé¦–ä¸ºå‡å·ï¼Œåˆ™è¯¥ä»£ç å—ç¬¦åˆåˆ—è¡¨é¡¹è§„åˆ™</span></span><br><span class="line">        <span class="keyword">return</span> block[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">self, block, handler</span>):</span></span><br><span class="line">        handler.start(self.<span class="built_in">type</span>)        <span class="comment"># æ‰“å° &lt;li&gt; æ ‡ç­¾å¤´</span></span><br><span class="line">        handler.feed(block[<span class="number">1</span>:].strip()) <span class="comment"># æ‰“å° &lt;li&gt; æ ‡ç­¾çš„ text éƒ¨åˆ†ï¼Œæ³¨æ„å»æ‰å‡å·</span></span><br><span class="line">        handler.end(self.<span class="built_in">type</span>)          <span class="comment"># æ‰“å° &lt;li&gt; æ ‡ç­¾å°¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>                     <span class="comment"># å¤„ç†å®Œæ¯•ï¼Œè¿”å› True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListRule</span>(<span class="params">ListItemRule</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ—è¡¨è§„åˆ™ï¼Œ&lt;ul&gt; æ ‡ç­¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">type</span> = <span class="string">&#x27;list&#x27;</span>   <span class="comment"># æ–‡æœ¬å—ç±»å‹</span></span><br><span class="line">    inside = <span class="literal">False</span>  <span class="comment"># è¯¥å€¼äº¦ä¸ºæµ®åŠ¨å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºåˆ—è¡¨è§„åˆ™</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">condition</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        <span class="comment"># åˆ¤æ–­ä»£ç å—æ˜¯å¦ç¬¦åˆè§„åˆ™è¿™é‡Œè¿”å› True</span></span><br><span class="line">        <span class="comment"># åœ¨ action æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»çš„åŒåæ–¹æ³•å†æ¬¡åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">self, block, handler</span>):</span></span><br><span class="line">        <span class="comment"># å¦‚æœ self.inside ä¸º False ä¸”çˆ¶ç±»çš„ condition æ–¹æ³•è¿”å›å€¼ä¸º True</span></span><br><span class="line">        <span class="comment"># ç¬¬ä¸€æ¬¡å‡ºç°ç¬¦åˆåˆ—è¡¨é¡¹è§„åˆ™çš„æ–‡æœ¬å—æ—¶ï¼Œæ»¡è¶³è¿™ä¸¤ä¸ªè¦æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.inside <span class="keyword">and</span> <span class="built_in">super</span>().condition(block):</span><br><span class="line">            <span class="comment"># æ‰“å° &lt;ul&gt; æ ‡ç­¾å¤´</span></span><br><span class="line">            handler.start(self.<span class="built_in">type</span>)</span><br><span class="line">            <span class="comment"># å°† inside å±æ€§å€¼æ”¹ä¸º True</span></span><br><span class="line">            self.inside = <span class="literal">True</span></span><br><span class="line">        <span class="comment"># æ‰“å°ä¸€å †è¿ç»­ li æ ‡ç­¾åï¼Œå‡ºç°éåˆ—è¡¨é¡¹è§„åˆ™çš„æ–‡æœ¬å—</span></span><br><span class="line">        <span class="keyword">elif</span> self.inside <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">super</span>().condition(block):</span><br><span class="line">            <span class="comment"># æ‰“å° &lt;ul&gt; æ ‡ç­¾å°¾</span></span><br><span class="line">            handler.end(self.<span class="built_in">type</span>)</span><br><span class="line">            <span class="comment"># å†æ¬¡ä¿®æ”¹ inside å±æ€§ä¸º False</span></span><br><span class="line">            self.inside = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># è¯¥æ–¹æ³•åªç”¨äºåœ¨åˆé€‚çš„æ¡ä»¶ä¸‹æ‰“å° &lt;ul&gt; æ ‡ç­¾</span></span><br><span class="line">        <span class="comment"># æ°¸è¿œè¿”å› False ï¼Œä»¥è°ƒç”¨å…¶å®ƒè§„åˆ™å®ä¾‹ç»§ç»­å¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ParagraphRule</span>(<span class="params">Rule</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ®µè½è§„åˆ™ï¼Œ&lt;p&gt; æ ‡ç­¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">type</span> = <span class="string">&#x27;paragraph&#x27;</span>  <span class="comment"># æ–‡æœ¬å—ç±»å‹</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">condition</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        <span class="comment"># ä¸ç¬¦åˆä»¥ä¸Šå„ç±»çš„åˆ¤æ–­è§„åˆ™çš„ä»£ç å—ä¸€å¾‹æŒ‰æ­¤è§„åˆ™å¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„è¿™ä¸ªåˆ—è¡¨ä¸­å®ä¾‹çš„é¡ºåºä¸èƒ½éšæ„æ”¹åŠ¨ï¼ŒåŸå› å‚è§ç›¸åº”ç±»ä¸­çš„æ³¨é‡Šè¯´æ˜</span></span><br><span class="line">rule_list = [ListRule(), ListItemRule(), TitleRule(), HeadingRule(),</span><br><span class="line">        ParagraphRule()]</span><br></pre></td></tr></table></figure><p>###4.markup.py</p><figure class="highlight plaintext"><figcaption><span>-*- coding: UTF-8 -*-</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import sys, re</span><br><span class="line">from handlers import HTMLRenderer</span><br><span class="line">from util import blocks</span><br><span class="line">from rules import rule_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Parser:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    è§£æå™¨çˆ¶ç±»</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    def __init__(self, handler):</span><br><span class="line">        self.handler = handler</span><br><span class="line">        self.rules = []     # åˆ¤æ–­æ–‡æœ¬å—è§„åˆ™çš„å®ä¾‹åˆ—è¡¨</span><br><span class="line">        self.filters = []   # è¿‡æ»¤æ–¹æ³•åˆ—è¡¨</span><br><span class="line"></span><br><span class="line">    def addRule(self, rule):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        å‘ self.rules åˆ—è¡¨ä¸­æ·»åŠ è§„åˆ™ç±»çš„å®ä¾‹</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        self.rules.append(rule)</span><br><span class="line"></span><br><span class="line">    def addFilter(self, pattern, name):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        å‘ self.filters åˆ—è¡¨ä¸­æ·»åŠ è¿‡æ»¤å‡½æ•°</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        # è¯¥è¿‡æ»¤å™¨å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šæ–‡æœ¬å—å’Œ HTMLRenderer ç±»çš„å®ä¾‹</span><br><span class="line">        def filter(block, handler):</span><br><span class="line">            # re.sub æ¥æ”¶ä¸‰ä¸ªå‚æ•° a b c ï¼Œå°†å­—ç¬¦ä¸² c ä¸­çš„ a å­—æ®µæ›¿æ¢æˆ b</span><br><span class="line">            # b çš„å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–å‡½æ•°</span><br><span class="line">            # åœ¨ä¸‹ä¸€è¡Œä»£ç ä¸­ b å‚æ•°çš„å€¼ä¸º handler çš„ sub æ–¹æ³•çš„è¿”å›å€¼</span><br><span class="line">            # sub æ–¹æ³•çš„å‚æ•° name çš„å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå®ƒå’Œ &#x27;sub_&#x27; ç»„æˆä¸€ä¸ªå¤§å­—ç¬¦ä¸²</span><br><span class="line">            # å¤§å­—ç¬¦ä¸²å°±æ˜¯ handler çš„ä¸€ä¸ªæ–¹æ³•å</span><br><span class="line">            return re.sub(pattern, handler.sub(name), block)</span><br><span class="line">        self.filters.append(filter)</span><br><span class="line"></span><br><span class="line">    def parse(self, file):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        æ ¸å¿ƒæ–¹æ³•ï¼Œè§£ææ–‡æœ¬ï¼Œæ‰“å°ç¬¦åˆè¦æ±‚çš„æ ‡ç­¾ï¼Œå†™å…¥æ–°çš„æ–‡ä»¶ä¸­</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        # è°ƒç”¨ handler å®ä¾‹çš„ start æ–¹æ³•ï¼Œå‚æ•°ä¸º handler å®ä¾‹çš„æŸä¸ªæ–¹æ³•åçš„ä¸€éƒ¨åˆ†</span><br><span class="line">        # ç»“æœå°±æ˜¯è°ƒç”¨ handler çš„ start_document æ–¹æ³•ï¼Œæ‰“å°æ–‡æ¡£çš„ head æ ‡ç­¾</span><br><span class="line">        self.handler.start(&#x27;document&#x27;)</span><br><span class="line">        # blocks æ˜¯ä» urti.py æ–‡ä»¶å¼•å…¥çš„ç”Ÿæˆå™¨å‡½æ•°</span><br><span class="line">        # blocks(file) å°±æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨</span><br><span class="line">        # ä½¿ç”¨ for å¾ªç¯ç”Ÿæˆå™¨</span><br><span class="line">        for block in blocks(file):</span><br><span class="line">            # è°ƒç”¨è¿‡æ»¤å™¨ï¼Œå¯¹æ¯ä¸ªæ–‡æœ¬å—è¿›è¡Œå¤„ç†</span><br><span class="line">            for filter in self.filters:</span><br><span class="line">                block = filter(block, self.handler)</span><br><span class="line">            # å¾ªç¯è§„åˆ™ç±»çš„å®ä¾‹</span><br><span class="line">            for rule in self.rules:</span><br><span class="line">                # å¦‚æœç¬¦åˆè§„åˆ™ï¼Œè°ƒç”¨å®ä¾‹çš„ action æ–¹æ³•æ‰“å°æ ‡ç­¾</span><br><span class="line">                if rule.condition(block):</span><br><span class="line">                    last = rule.action(block, self.handler)</span><br><span class="line">                    # å¦‚æœ action æ–¹æ³•çš„è¿”å›å€¼ä¸º True</span><br><span class="line">                    # è¡¨ç¤ºè¯¥æ–‡æœ¬å—å¤„ç†å®Œæ¯•ï¼Œç»“æŸå¾ªç¯</span><br><span class="line">                    if last:</span><br><span class="line">                        break</span><br><span class="line">        # åŒ self.handler.start</span><br><span class="line">        # è°ƒç”¨ handler çš„ end_document æ–¹æ³•æ‰“å° &#x27;&lt;/body&gt;&lt;/html&gt;&#x27;</span><br><span class="line">        self.handler.end(&#x27;document&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class BasicTextParser(Parser):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    çº¯æ–‡æœ¬è§£æå™¨</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self, handler):</span><br><span class="line">        # è¿è¡Œçˆ¶ç±» Parser çš„åŒåæ–¹æ³•</span><br><span class="line">        super().__init__(handler)</span><br><span class="line">        # å¢åŠ è§„åˆ™ç±»çš„å®ä¾‹åˆ° self.urls åˆ—è¡¨</span><br><span class="line">        for rule in rule_list:</span><br><span class="line">            self.addRule(rule)</span><br><span class="line">        # å¢åŠ ä¸‰ä¸ªè¿‡æ»¤å‡½æ•°ï¼Œåˆ†åˆ«å¤„ç†æ–œä½“å­—æ®µã€é“¾æ¥å’Œé‚®ç®±</span><br><span class="line">        self.addFilter(r&#x27;\*(.+?)\*&#x27;, &#x27;emphasis&#x27;)</span><br><span class="line">        self.addFilter(r&#x27;(http://[\.a-zA-Z/]+)&#x27;, &#x27;url&#x27;)</span><br><span class="line">        self.addFilter(r&#x27;([\.a-zA-Z]+@[\.a-zA-Z]+[a-zA-Z]+)&#x27;, &#x27;mail&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    ä¸»å‡½æ•°ï¼Œæ§åˆ¶æ•´ä¸ªç¨‹åºçš„è¿è¡Œ</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    handler = HTMLRenderer()</span><br><span class="line">    parser = BasicTextParser(handler)</span><br><span class="line">    # å°†æ–‡ä»¶å†…å®¹ä½œä¸ºæ ‡å‡†è¾“å…¥ï¼Œsys.stdin è·å–æ ‡å‡†è¾“å…¥çš„å†…å®¹ï¼Œç”Ÿæˆ IOWrapper è¿­ä»£å™¨å¯¹è±¡</span><br><span class="line">    parser.parse(sys.stdin)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="å››ã€-ç»“æœåŠåˆ†æ"><a href="#å››ã€-ç»“æœåŠåˆ†æ" class="headerlink" title="å››ã€ ç»“æœåŠåˆ†æ"></a>å››ã€ ç»“æœåŠåˆ†æ</h2><p> åœ¨è¿™ä¸ªå°ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Python æ¥è§£æçº¯æ–‡æœ¬æ–‡ä»¶å¹¶ç”Ÿæˆ HTML æ–‡ä»¶ï¼Œè¿™ä¸ªåªæ˜¯ç®€å•å®ç°ï¼Œæ”¯æŒäº†å¾ˆå°‘éƒ¨åˆ†çš„ Markdown è¯­æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ¡ˆä¾‹å¤§å®¶å¯ä»¥åŠ¨æ‰‹è¯•è¯•è§£æå®Œæ•´çš„ Markdown æ–‡ä»¶ã€‚<br><img data-src="https://img-blog.csdnimg.cn/img_convert/7deabee8376b85861440a40a93af0f4c.png" alt="å›¾ç‰‡æè¿°"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å››å…­çº§ç­”æ¡ˆ</title>
      <link href="2021/06/12/%E5%9B%9B%E5%85%AD%E7%BA%A7%E7%AD%94%E6%A1%88/"/>
      <url>2021/06/12/%E5%9B%9B%E5%85%AD%E7%BA%A7%E7%AD%94%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p>(ç‚¹ğŸ‘‰)<a href="http://mp.weixin.qq.com/s?__biz=Mzk0NDE4MjM5Mg==&mid=100000027&idx=1&sn=12da22c15d1a069b5b3f617d0859d699&chksm=4329c40c745e4d1a8fc9ba94c1739750ca362e983aeec87d2246292c0e5b50b5a4f658b63d6c&mpshare=1&scene=23&srcid=0612AdTe5l0FxaVNLwgFefgs&sharer_sharetime=1623473761114&sharer_shareid=607d95b460436718ba01b46fbb316f57#rd">å››çº§ç­”æ¡ˆ</a><br>ä¸‹åˆå…­çº§ç»“æŸä¼šæœ‰å…­çº§ç­”æ¡ˆ</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘æ–‡ç« æ­¥éª¤</title>
      <link href="2021/05/28/%E5%8F%91%E6%96%87%E7%AB%A0%E6%AD%A5%E9%AA%A4/"/>
      <url>2021/05/28/%E5%8F%91%E6%96%87%E7%AB%A0%E6%AD%A5%E9%AA%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="å‘æ–‡ç« çš„æ­¥éª¤"><a href="#å‘æ–‡ç« çš„æ­¥éª¤" class="headerlink" title="å‘æ–‡ç« çš„æ­¥éª¤"></a>å‘æ–‡ç« çš„æ­¥éª¤</h2><span id="more"></span><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æŠ€èƒ½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸€ç¯‡blog</title>
      <link href="2021/05/28/%E7%AC%AC%E4%B8%80%E7%AF%87blog/"/>
      <url>2021/05/28/%E7%AC%AC%E4%B8%80%E7%AF%87blog/</url>
      
        <content type="html"><![CDATA[<p>æ¬¢è¿æ¥åˆ°<a href="https://shineme.ltd/">Shinemeçš„ä¸–ç•Œ</a>ï¼Œè¿™é‡Œæ˜¯æˆ‘çš„åšå®¢ï¼Œä¹Ÿæ¬¢è¿å°ä¼™ä¼´ä»¬è®¿é—®æˆ‘çš„<a href="http://xmt.shineme.ltd/">ä¸ªäººä¸»é¡µ</a> or you can ask me on <a href="https://github.com/xmt3061123">GitHub</a>.</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
